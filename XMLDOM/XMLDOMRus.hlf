.Language=Russian,Russian (Русский)
.PluginContents=XML Browser

@Contents
$^#XML Browser Plugin#

   ~Описание~@Description@

   ~Клавишные команды~@Keyboard@

   ~Поддержка XPath~@XPath@

   ~Редактирование~@Editing@
   
   ~Переопределение столбцов через XPath~@Special@

   ~Настройка~@Config@

   ~Известные проблемы~@Problems@

@-
----------------------------------------
Новые версии см. на ~http://michael-y.org/FAR~@http://michael-y.org/FAR@.
 yutsis@@gmail.com


@Description
$ #Описание#

Этот плагин показывает содержимое любого файла XML или иного ресурса
в этом формате (локального или в Интернете) в виде каталога или архива.
"Подкаталогами" являются элементы (теги) внутри текущего элемента, а 
"файлами" - атрибуты текущего элемента, текстовое содержание, комментарии
и разделы CDATA.

Плагин работает через Microsoft XML DOM services, обеспечиваемый библиотекой
#msxml3.dll#.

В качестве "имени каталога" для элемента XML берётся его атрибут "Name",
или "Id", или, если ни один из них не обнаружен, имя его тега. (Список
таких атрибутов можно настраивать.) Корневой элемент показывается
всегда по имени тега. Можно принудительно включить показ тегов в столбце 
имён клавишей #Ctrl-N#.

Значения атрибутов и текст внутри элементов показываются в столбце описаний.
Имена тегов показываются в столбце "Владелец".

Если у двух и более элементов одинаковый тег, они показываются с индексами:
item[0], item[1] и т.д.

Любой элемент или атрибут можно смотреть/редактировать клавишей F3/F4.
При нажатии F3 или F4 на ".." будет показан весь текущий элемент целиком.
"Подэлементы" (элементы внутри текущего элемента) извлекаются в формате XML,
но без заголовка. Возможно, это будет изменено в будущем.

Поддерживается выбор элементов с помощью ~XPath~@XPath@ и вычисление выражений XPath.

Можно также открыть любой файл или интернетный ресурс с командной строки
с помощью префикса #xml:#, например:
@-

 #xml:C:\WINDOWS\ServicePackFiles\i386\filelist.xml#
или
 #xml:http://www.livejournal.com/users/news/rss#

Можно также добавить через символ ':' суффикс в формате ~XPath~@XPath@
для автоматического выбора нужных данных уже при открытии файла:

#xml:System.xml:/doc/members/member[@@name="T:Microsoft.Win32.SystemEvents"]#
#xml:http://www.livejournal.com/users/news/rss://item/description|//item/pubDate#

Если результат выбора содержит только один элемент, плагин сразу заходит в 
него, как если бы это была команда "сменить каталог".

@Problems
$ #Известные проблемы#

Сообщение #Класс не зарегистрирован# означает, что у вас отсутствуют
или не зарегистрирована msxml3.dll. Обеспечьте ее наличие и,
если надо, зарегистрируйте её:
#regsvr32 msxml3.dll#.

Internet Explorer версии 5 и выше включает msxml3.dll.

@Keyboard
$ #Клавишные команды#

#Shift-F7#  Переключить между ~режимами~@modes@ "Элементы как файлы" и
            "Элементы как каталоги".

#Ctrl-F#    Поместить XPath текущего элемента в командную строку.

#Alt-Shif-Ins# Поместить XPath'ы текущих элементов в клипборд.

#Ctrl-G#    Поместить содержимое столбца описаний в командную строку.

#Ctrl-Z#    Открыть описание в диалоге редактирования. Редактировать
          сейчас можно только атрибуты, текст и комментарии.

#Ctrl-N#    Включить/выключить показ "только тегов" в столбце "Имя".

#Ctrl-H#    Спрятать/показать описания элементов. Это может существенно
          ускорить перечитывание, поскольку теперь плагин не будет
          запрашивать текст для каждого элемента. Когда элементов
          не очень много (менее 500), их описания показываются всегда.

#Alt-Shift-F3# Просмотреть группу выделенных элементов в одном вьюере.
          Работает, только если опция "Разрешить внешние связи"
          включена.

#Alt-Shift-F4# Просмотреть группу выделенных ключей в одном
               редакторе. (Редактирование не поддерживается.)

#Alt-Shift-F11# ~Диалог переопределения столбцов~@Special@

#Shift-F3#  Просмотреть ~определение~@ViewDef@ элемента в схеме (если оно есть).
           Работает, только если опция "Разрешить внешние связи"
           включена.

#Shift-F2#  Сохранить изменения

#Shift-Enter#  Открыть элемент в браузере или другой программе,
             которая в системе определена для просмотра XML.

#Alt-Shift-Up/Down# В режиме без сортировки: переместить элемент вверх или вниз.
                 (Не для атрибутов.)

#Ctrl-Shift-F5# Дублировать выбранный(-е) элемент(ы).

#Примечание 1.# Описания, получаемые через Ctrl-G или Ctrl-Z, усекаются до 256 
символов. Чтобы экспортировать целую секцию, используйте F3/F4. 

#Примечание 2.# Alt-Shift-NumPad5 работает как Alt-Shift-F3.

@Modes
$ #Режимы работы#

 Есть два режима работы плагина:

#Элементы как каталоги#. Элементы выделяются цветом согласно
раскраске файлов и при сортировке идут _перед_ параметрами. В режиме 
QuickView виден суммарный размер всех атрибутов под текущим ключом.

#Элементы как файлы.# Элементы можно отличить от переменных, только если включен
показ размера, он для них равен 0. Элементы можно просматривать через
QuickView на второй панели.

При нажатии в этом режиме Ctrl-PgDn содержимое элемента
экспортируется во временный файл, и этот файл вновь открывается плагином.

В большинстве случаев рекомендуется режим "Ключи как каталоги".

Переключение между этими режимами - #Shift-F7#.

@ViewDef
$^Просмотр определения

Эта команда просматривает определения.

Она показывает:

если есть DTD - то его;

если есть схема XDR - то определение типа узла.

Всё это в будущих версиях может изменяться.

Команда работает, только если опция "Разрешить внешние связи" включена.

@Config
$ #Настройка#
@-
#Экспортировать XML в кодовой странице#
( ) UTF-8
( ) Windows

@+
Элементы XML могут экспортироваться или в формате UTF-8 (он является 
стандартным для XML), или в текущей кодовой странице Windows.

#UTF-8# более универсален и предпочтителен, в нём отображаются любые 
символы и не теряется информация, но в FAR'е 1.xx вьюер и редактор не понимают 
его без посторонней помощи. Notepad хорошо его понимает и может быть
использован для просмотра UTF-8 как альтернативный редактор (Alt-F4).

В #кодовой странице Windows# можно экспортировать только ограниченный 
набор символов: напр., если она кириллическая (1251), то французские и немецкие буквы с 
акцентами не пройдут. В этом режиме к файлу добавляется заголовок XML, 
показывающий кодовую страницу, в которой файл был экспортирован.

#Добавить в меню внешних модулей#

Если включено, плагин показывает пункт меню "XML browser" в меню плагинов (F11).
Когда он выбирается, открывается текущий файл под курсором.
По умолчанию эта избыточная возможность отключена, чтобы не засорять меню F11.

#Открывать файлы XML с панели FAR#

Обычно эта возможность включена. Когда оны выключена, запрещается прямое 
открытие файлов плагином из FAR'а по нажатию Enter или Ctrl-PgDn, или при 
поиске по Alt-F7 с включённой опцией "Искать в архивах". Вы можете 
захотеть её выключить именно в последнем случае, если не хотите, чтобы FAR 
при поиске считал XMLы тоже архивами.

Даже когда эта опция выключена, всё равно можно открывать файлы XML с 
командной строки, используя префикс #xml:#.

#Проверять XML при загрузке#

Указывает, надо ли проверять XML при открытии по его DTD и схеме.
Если выключен, XML проверяется только на "правильную сформированность".

#Разрешать внешние связи#

Указывает, надо ли разрешать при загрузке внешние определения, разрешаемые
пространства имён, внешние DTD и т.д., вне зависимости от проверки.

Для использования команды "Просмотреть определение" (Shift-F3)
эта опция должна быть включена.

#Начальный режим без сортировки#

Если включен, плагин открывает файлы XML в режиме без сортировки,
отображая физический порядок элементов в файле.

Если выключен, элементы сортируются согласно установке текущей панели.

#Атрибуты, показываемые как "Имя"#

Перечислите здесь атрибуты, которые вы хотите видеть в столбце имени файла.
Они должны разделяться запятыми или пробелами. Регистр различается.


@Editing
$ #Редактирование#

Сейчас над содержимым файла XML можно выполнять следующие операции 
редактирования:
@-
- изменять атрибуты и текстовые элементы через диалог по Ctrl-Z;

- редактировать любые элементы в редакторе по F4;

- удалять элементы и атрибуты.

@+
Изменения будут показаны на панели немедленно, но результаты
не сохранятся в файл, пока вы не нажмёте #Shift-F2#.

Если содержимое изменено, к заголовку панели добавляются звёздочки.

При сохранении результатов прежний файл переименовывается в .bak .
Старый .bak удаляется.

@XPath
$ #Поддержка XPath#

Для выбора подмножества элементов можно использовать язык запросов XPath.
Чтобы сделать это внутри плагина, нажмите #Ctrl-J# и введите выражение XPath.
На панели появится результат выбора. Если зайти в один из элементов 
результата и выйти назад, результат выбора всё равно останется.
Когда на панели находится результат выбора, то выйдя через "..",
вы возвращаетесь на исходный узел, из которого делался выбор, а сам выбор
отменяется.
Ещё один способ отменить выбор - применить пустое выражение XPath.

При открытии файла или интернет-ресурса с командной строки можно также 
добавить через двоеточие выражение XPath, и тогда при открытии файла
автоматически будет сделан выбор нужной информации.

Кроме выбора элементов, можно использовать XPath-выражения, возвращающие "скалярное" значение.
Такое значение будет выводиться в окне сообщения.

О синтаксисе XPath можно прочесть здесь:
 ~http://www.w3schools.com/xpath/~@http://www.w3schools.com/xpath/@
 ~http://www.w3.org/TR/xpath20/~@http://www.w3.org/TR/xpath20/@
 ~http://msdn.microsoft.com/library/en-us/xmlsdk/htm/xpath_ref_overview_0pph.asp~@http://msdn.microsoft.com/library/en-us/xmlsdk/htm/xpath_ref_overview_0pph.asp@

Примеры запросов XPath:

@-
#elem#		Выбрать все элементы <elem> под текущим элементом.
#*/summary#	Выбрать все подэлементы <summary> всех элементов под текущим элементом.
#/book/chapter[3]/para[1]#  Выбрать первый абзац третьей главы книги
#//@@name#	Дать список всех атрибутов "name" в файле
#//text()#  	Дать список всех текстовых элементов в файле

@+
Команда #cd# также понимает запросы XPath. Когда выражение XPath
вводится в команде #cd#, и его результатом является один элемент, плагин
заходит в этот элемент.

@Special
$^#Переопределение содержимого столбцов через XPath#

Для любого конкретного типа элемента в данном типе документа XML можно задать относительные выражения XPath, которые будут использоваться
для показа содержимого столбцов #Имя#, #Дата/Время#, #Описание# и #Владелец#.

Для этого надо нажать #Alt-Shift-F11#, когда курсор находится на элементе, показ которого вы хотите
переопределить, и заполнить в диалоге следующие поля:

#Корневой тег документа# (обязателен) - корневой тег того документа, в 
котором находится переопределяемый элемент. Заполняется сам из 
текущего документа, но его можно и поменять, чтобы создать определение 
для другого типа документа.

#Тег элемента# (обязателен) - тег элемента, показ которого вы хотите 
переопределить. Заполняется сам из элемента под курсором (если 
есть), но его можно и поменять, чтобы создать определение для другого элемента.

#XPath для имени# (необяз.) - выражение XPath относительно этого элемента, 
задающее значение, показываемое в столбце имени.

Простейшие примеры: если вы хотите показывать в столбце "Имя" содержимое подэлементов <Name>,
то строка будет просто #Name#; если хотите показывать значение атрибута "desc",
то строка - #@@desc#, и т.д.

#XPath для даты и времени# (необяз.) - выражение XPath относительно этого 
элемента, задающее значения, показываемые в столбцах даты и времени.

Дата и время, извлекаемые при этом из текста, понимаются в одном из двух форматов:
либо RFC 822 (как в документах RSS), либо RFC 3339 (как в Atom).

#XPath для описания# (необяз.) - выражение XPath относительно этого 
элемента, задающее значение, показываемое в столбце описания.

#XPath для владельца# (необяз.) - выражение XPath относительно этого 
элемента, задающее значение, показываемое в столбце владельца.

Для каждого элемента, для которого есть определение, будет выполняться выбор
по этому выражению, и результирующий текст будет показываться в столбце.
Таким образом можно показывать в этих столбцах любые атрибуты и любой 
текст между тегами под каждым из элементов.

Если ни одна из четырёх строк не определена, определение для этого элемента удаляется.

В FAR 1 и 2 все определения хранятся в реестре в довольно очевидном формате (если это 
вдруг понадобится) под ключом плагина Plugins\YMS\XMLDOM\Special.

#Примечание 1.# Эти определения имеют приоритет перед параметром "атрибуты, 
показываемые как Имя", который задается в ~конфигурации~@Config@.

#Примечание 2.# Как и с этими атрибутами, показ можно переключать нажатием Ctrl-N.

#Примечание 3.# Можно задавать и "скалярные" выражения XPath, возвращающие одиночные значения, а не
элементы XML, например, с использованием функций типа concat и т.п.


#Пример.#

Для примера рассмотрим формат подачи новостей RSS (из ~http://en.wikipedia.org/wiki/RSS~@http://en.wikipedia.org/wiki/RSS@):

 <?xml version="1.0"?>
 <#rss# version="2.0">
  <channel>
    .............
    <#item#>
      <#title#>Star City</title>
      <link>http://liftoff.msfc.nasa.gov/news/2003/news-starcity.asp</link>
      <#description#>How do Americans get ready to work with Russians aboard the
        International Space Station? They take a crash course in culture, language
        and protocol at Russia's Star City.</description>
      <#pubDate#>Tue, 03 Jun 2003 09:39:21 GMT</pubDate>
      <guid>http://liftoff.msfc.nasa.gov/2003/06/03.html##item573</guid>
    </item>
    <#item#>
      <#title#>Space Exploration</title>
      <link>http://liftoff.msfc.nasa.gov/</link>
      <#description#>Sky watchers in Europe, Asia, and parts of Alaska and Canada
        will experience a partial eclipse of the Sun on Saturday, May 31.</description>
      <#pubDate#>Fri, 30 May 2003 11:06:42 GMT</pubDate>
      <guid>http://liftoff.msfc.nasa.gov/2003/05/30.html##item572</guid>
    </item>
    ..............
  </channel>
 </rss>

Для показа выделенных элементов в соответствующих столбцах для каждого 
"item"-а надо создать следующее определение, нажав Alt-Shift-F11. (Если 
при этом курсор будет стоять на элементе "item", первые два поля 
заполнятся сами.)

 Корневой тег документа: ~rss~
 Тег элемента: ~item~
 XPath для имени: ~title~
 XPath для даты и времени: ~pubDate~
 XPath для описания: ~description~

@WinError
$ #Ошибка Windows#

Это сообщение показывается плагином, когда происходит какая-либо ошибка Windows.

Текст сообщения берется у Windows. На невнятные сообщения об ошибках
просьба не пенять: что система дает, то и показываем.
